---
title: "Testing Apache Cassandra database throughput for different consistency levels"
output: 
  html_document: 
    theme: spacelab
    toc: yes
    toc_float: true
---
```{r pobieranie bibliotek, message = FALSE, echo = FALSE}
library(ggplot2)
library(plotly)
library(tidyr)
```

```{r ³adowanie danych, echo = FALSE, cache = TRUE}
data <- read.csv2(file = "./result.csv")
data <- data[data$throughput != 0, ]
```

#Data summary
```{r podsumowanie, echo = FALSE}
knitr::kable(summary(data))
```

#Workloads description
#####A: 50% read / 50% write
#####B: 95% read / 5% write
#####C: 100% read
#####D: read latest workload
#####F: read-modify-write

#Results in boxplot
```{r result boxplot, fig.height=10, fig.width=10, echo = FALSE}
plot_box <-ggplot(data, aes(x = consistency_level, y = throughput, fill = consistency_level, color = consistency_level)) +
  geom_boxplot() +
  facet_grid(workload~nodes) +
  theme(axis.text.x = element_text(angle = 45)) +
  xlab(label = "Consistency level") +
  ylab(label = "Throughput") +
  labs(color = "Consistency level", fill = "Consistency level")

ggplotly(plot_box)
```

#Results in points plot
```{r result points, fig.height=10, fig.width=10, echo = FALSE}
plot_point <-ggplot(data, aes(x = consistency_level, y = throughput, fill = consistency_level, color = consistency_level)) +
  geom_point() +
  facet_grid(workload~nodes) +
  theme(axis.text.x = element_text(angle = 45)) +
  xlab(label = "Consistency level") +
  ylab(label = "Throughput (ops/sec)") +
  labs(color = "Consistency level", fill = "Consistency level")

ggplotly(plot_point)
```

#Results in points plot with jitter
```{r result points jitter, fig.height=10, fig.width=10, echo = FALSE}
plot_point_jit <-ggplot(data, aes(x = consistency_level, y = throughput, fill = consistency_level, color = consistency_level)) +
  geom_point(position = "jitter") +
  facet_grid(workload~nodes) +
  theme(axis.text.x = element_text(angle = 45)) +
  xlab(label = "Consistency level") +
  ylab(label = "Throughput (ops/sec)") +
  labs(color = "Consistency level", fill = "Consistency level")

ggplotly(plot_point_jit)
```

#Results in line plots
```{r result line, fig.height=10, fig.width=10, echo = FALSE}
data_means <- data %>%
  group_by(workload, nodes, consistency_level) %>%
  summarise(throughput = mean(throughput))

plot_line <- ggplot(data_means, aes(x = nodes, y = throughput, color = consistency_level, order = c("..."))) +
  geom_line() +
  geom_point() +
  facet_wrap(~workload) +
  xlab(label = "Nodes") +
  ylab(label = "Throughput (ops/sec)") +
  labs(color = "Consistency level")

ggplotly(plot_line)
```
